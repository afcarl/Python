# To do

# Experiments with CNN with contains/contains-1

Getting f1 for contains: 0.55186440678
all scores: [ 0.9728062   0.55186441  0.        ]

On WM GPU with these settings:

batches = 50
epochs = 3
embdims = 300
filters = 100
filtlen = 2,3,4
dropout = 0.25
learnrt = 0.0001

# Experiments with LSTM with contains/contains-1

Getting f1 for contains: 0.539354294155
all scores: [ 0.97029156  0.53935429  0.10397554]

batches = 50
epochs = 3
embdims = 300

# Experiments with LSTM (old data representation)

* Bi-directional LSTM, F1 = 0.4771
* LSTM with non-arg events marked as <e>...</e> F1 = 0.54885
* LSTM(64) / embedding dropout=0.2, watermelon, F1 = 0.5532
* GRU(64) / embedding dropout=0.2, watermelon, F1 = 0.5591
* LSTM with large number of epochs improves F1 for other relations but worse for Contains

# Experiments with CNN (old data representation)

* 06/15 ran cnn.py and F1 now lower than before (0.5). Investigate.
* F1 = 0.5462 for filter sizes 1,2 (is this best performance now)?
* F1 = 0.5158 for filter size 2,3
* F1 around 0.16 for <e> event </e> ... <e> event2 </e> ...
* F1 < 0.50 for <e1> event </e1> ... <e2> event2 </e> ...
* F1 0.39 for two words on the left of e and 0 words on the right
* F1 0.5236 2-word context with args enclosed in <arg1></arg1> and <arg2></arg2>
* F1 0.5266 same as above + learning alphabet from train+dev
* F1 0.5369 added a hidden layer after convolution

# Misc Experiments

* Binary classificaiton contains/none worse than 10-class

# Examples

contains|echocardiogram noted
contains|echocardiogram noted severe bi-atrial enlargement
contains|echocardiogram noted severe bi-atrial enlargement and aortic valve stenosis
none|noted severe bi-atrial enlargement
none|noted severe bi-atrial enlargement and aortic valve stenosis
none|enlargement and aortic valve stenosis

continues|continued to experience
continues|continued to experience respiratory distress
none|continued to experience respiratory distress and eventually was intubated
contains|experience respiratory distress
before|experience respiratory distress and eventually was intubated
before|distress and eventually was intubated
contains|scan of the chest noted
contains|scan of the chest noted a tiny indeterminate pulmonary nodule
contains|scan of the chest noted a tiny indeterminate pulmonary nodule of the right base
adjacent to the diaphragm and mildly prominent subcarinal and right hilar lymph nodes
none|noted a tiny indeterminate pulmonary nodule
none|noted a tiny indeterminate pulmonary nodule of the right base adjacent to the
diaphragm and mildly prominent subcarinal and right hilar lymph nodes
none|nodule of the right base adjacent to the diaphragm and mildly prominent subcarinal
and right hilar lymph nodes

# Layers

* Embedding layer
* Convolution1D layer
* MaxPoolilng1D layer
* Dense layer (10 units)
* Softmax

# Training parameters

batch = 25
epochs = 5
embdims = 300
filters = 200
filtlen = 2

train_size = 78452 

# Dataset

THYME train + dev combined in one file:

alphabet size: 12352
max seq len: 139
number of examples: 122,624
number of labels: 10
label counts: Counter({0: 110778, 1: 6579, 7: 2759, 2: 1414, 3: 307, 4: 229, 6: 207, 5: 149, 9: 133, 8: 69})

# Results

[ 0.94121891  0.46448894  0.15781487  0.20183486  0.62569832  0.  0.42592593  0.11684518  0.          0.        ]

f1 for contains: 0.464488935722

label2int = {
  'none':0,
  'contains':1,
  'before':2,
  'begins-on':3,
  'continues':4,
  'ends-on':5,
  'initiates':6,
  'overlap':7,
  'reinitiates':8,
  'terminates':9
  }


# cTAKES system

P	R	F1	#gold	#system	#correct
0.582	0.554	0.568	2680	2553	1486	OVERALL

System predict relations #: 2553
# of system relations whose arguments are close: 1538
Gold relations #: 2680
# of gold relations whose arguments are close: 1670
